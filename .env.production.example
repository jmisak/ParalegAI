# IRONCLAD Production Environment Configuration
# This file documents required production environment variables
# Actual values should be set via secrets management (AWS Secrets Manager, HashiCorp Vault, etc.)

# =============================================================================
# APPLICATION
# =============================================================================
NODE_ENV=production
APP_PORT=3001
APP_HOST=0.0.0.0
LOG_LEVEL=info
TRUST_PROXY=true

# =============================================================================
# DATABASE
# =============================================================================
# Production PostgreSQL (RDS or equivalent)
# Use connection pooling (PgBouncer) in production
DATABASE_URL=postgresql://user:password@production-db.cluster.region.rds.amazonaws.com:5432/ironclad?schema=public&sslmode=require
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=20
DATABASE_IDLE_TIMEOUT=30000

# Read replica for queries (optional)
DATABASE_READ_REPLICA_URL=

# =============================================================================
# REDIS
# =============================================================================
# Production Redis (ElastiCache or equivalent)
REDIS_URL=rediss://user:password@production-redis.cache.amazonaws.com:6379/0
REDIS_CLUSTER_MODE=true

# =============================================================================
# AUTHENTICATION
# =============================================================================
# CRITICAL: Generate unique secrets for production
# Use: openssl rand -hex 32 for each secret
JWT_SECRET=GENERATE_WITH_openssl_rand_hex_32
SESSION_SECRET=GENERATE_WITH_openssl_rand_hex_32
CSRF_SECRET=GENERATE_WITH_openssl_rand_hex_32

# JWT configuration (production values)
JWT_ACCESS_TOKEN_EXPIRES=900
JWT_REFRESH_TOKEN_EXPIRES=604800

# Production Argon2 settings (adjust based on hardware)
ARGON2_MEMORY_COST=65536
ARGON2_TIME_COST=3
ARGON2_PARALLELISM=4

# =============================================================================
# SECURITY
# =============================================================================
# Production CORS (strict)
CORS_ORIGINS=https://ironclad.app,https://www.ironclad.app,https://app.ironclad.app

# Rate limiting (production values)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Audit log secret
AUDIT_LOG_SECRET=GENERATE_WITH_openssl_rand_hex_32

# =============================================================================
# ENCRYPTION
# =============================================================================
# CRITICAL: Use KMS-managed keys in production
# These should reference KMS key ARNs or Vault paths
MASTER_ENCRYPTION_KEY=aws-kms:///arn:aws:kms:region:account:key/key-id
FIELD_ENCRYPTION_KEY=aws-kms:///arn:aws:kms:region:account:key/key-id

# Key rotation schedule (days)
KEY_ROTATION_DAYS=90

# =============================================================================
# AI PROVIDERS
# =============================================================================
# Production API keys (from secrets manager)
ANTHROPIC_API_KEY=FROM_SECRETS_MANAGER
OPENAI_API_KEY=FROM_SECRETS_MANAGER

# Production AI settings
AI_GATEWAY_TIMEOUT=30000
AI_MAX_TOKENS=4096
AI_TEMPERATURE=0.1

# =============================================================================
# STORAGE
# =============================================================================
# Production S3 bucket with encryption
S3_BUCKET=ironclad-documents-prod
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=FROM_IAM_ROLE
S3_SECRET_ACCESS_KEY=FROM_IAM_ROLE
S3_ENDPOINT=

# Server-side encryption
S3_SSE_ALGORITHM=aws:kms
S3_SSE_KMS_KEY_ID=arn:aws:kms:region:account:key/key-id

# =============================================================================
# EMAIL
# =============================================================================
# Production SMTP (SES or equivalent)
SMTP_HOST=email-smtp.us-east-1.amazonaws.com
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=FROM_SECRETS_MANAGER
SMTP_PASSWORD=FROM_SECRETS_MANAGER
SMTP_FROM=noreply@ironclad.app

# =============================================================================
# INTEGRATIONS
# =============================================================================
# DocuSign production
DOCUSIGN_INTEGRATION_KEY=FROM_SECRETS_MANAGER
DOCUSIGN_SECRET_KEY=FROM_SECRETS_MANAGER
DOCUSIGN_ACCOUNT_ID=FROM_SECRETS_MANAGER
DOCUSIGN_BASE_URL=https://na4.docusign.net/restapi

# =============================================================================
# MONITORING
# =============================================================================
# Sentry error tracking
SENTRY_DSN=https://key@sentry.io/project
SENTRY_ENVIRONMENT=production

# Application Performance Monitoring
APM_ENABLED=true
APM_SERVICE_NAME=ironclad-api

# CloudWatch / Datadog
CLOUDWATCH_LOG_GROUP=/ironclad/api/production

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_MFA_REQUIRED=true
FEATURE_AI_ENABLED=true
FEATURE_DOCUMENT_ANALYSIS=true

# =============================================================================
# PRODUCTION SECURITY CHECKLIST
# =============================================================================
# Before deploying to production, verify:
# [ ] All secrets are stored in secrets manager (not in env files)
# [ ] Database SSL/TLS is enabled
# [ ] Redis TLS is enabled
# [ ] S3 bucket encryption is enabled
# [ ] WAF is configured
# [ ] DDoS protection is enabled
# [ ] Log aggregation is configured
# [ ] Alerting is configured
# [ ] Backup encryption is enabled
# [ ] Key rotation is scheduled
# [ ] Security scanning is enabled
# [ ] Penetration testing is scheduled
